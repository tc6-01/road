# 抖音内容提取脚本

## 功能说明

这个Python脚本可以从抖音视频链接中提取地点和美食信息,并自动保存到数据文件中。

## 安装依赖

```bash
cd backend
pip install -r requirements.txt
```

## 配置API密钥

1. 复制项目根目录的 `.env.example` 文件并重命名为 `.env`
2. 填入你的API密钥:

```env
# 必需: 高德地图API密钥
AMAP_WEB_SERVICE_KEY=你的高德地图Web服务API密钥

# 推荐: DeepSeek AI API (用于自动提取信息)
DEEPSEEK_API_KEY=你的DeepSeek API密钥

# 可选: TikHub API (用于自动获取视频信息)
TIKHUB_API_KEY=你的TikHub API密钥
```

### API密钥获取指南

**高德地图API** (必需):
1. 访问 https://console.amap.com/
2. 注册/登录账号
3. 创建应用,选择"Web服务"类型
4. 获取API Key

**DeepSeek API** (推荐):
1. 访问 https://platform.deepseek.com/
2. 注册账号
3. 在API密钥页面创建新密钥
4. 价格实惠,中文理解能力强

**TikHub API** (可选):
- 如果不配置,脚本会使用手动输入模式
- 访问 https://api.tikhub.io/ 了解详情

## 使用方法

### 基本用法

```bash
python extractor.py --url "抖音视频链接"
```

### 工作流程

1. **获取视频信息**
   - 如果配置了TikHub API,自动获取视频标题、描述和封面
   - 否则,手动输入视频信息

2. **提取地点和美食**
   - 如果配置了AI API,自动分析提取
   - 否则,手动输入地点和美食信息

3. **获取地理坐标**
   - 自动调用高德地图API获取经纬度
   - 如果失败,可手动输入

4. **下载封面图片**
   - 自动下载并保存到 `frontend/public/images/`

5. **保存数据**
   - 追加到 `data/places.json` 文件

### 示例输出

```
==============================================================
抖音视频内容提取
==============================================================

正在获取视频信息...
=== 手动输入模式 ===
请根据抖音视频内容填写以下信息:

视频标题: 成都必吃的火锅
视频描述: 超好吃的老火锅,排队2小时也值得!

使用AI分析视频内容...
✓ AI提取完成
  地点: 小龙坎老火锅
  城市: 成都
  美食数量: 1

正在获取坐标: 成都...
✓ 坐标获取成功: (104.06667, 30.57222)

✓ 数据已保存到: /path/to/data/places.json
✓ 当前共有 1 个地点

==============================================================
✓ 提取完成!
==============================================================
```

## 注意事项

1. **API限制**: 抖音官方不提供公开API,自动获取视频信息需要第三方服务
2. **手动模式**: 即使没有配置任何API,脚本也可以手动输入模式运行
3. **数据安全**: 所有数据保存在本地,不会上传到任何服务器
4. **图片存储**: 封面图片较大时建议使用图床服务

## 常见问题

**Q: 不想配置这么多API怎么办?**
A: 只配置高德地图API即可,其他都可以手动输入。

**Q: 视频信息自动获取失败怎么办?**
A: 脚本会自动切换到手动输入模式,根据提示填写即可。

**Q: 如何批量处理多个视频?**
A: 可以写一个简单的bash脚本循环调用:
```bash
#!/bin/bash
urls=(
  "视频链接1"
  "视频链接2"
  "视频链接3"
)

for url in "${urls[@]}"; do
  python extractor.py --url "$url"
done
```

